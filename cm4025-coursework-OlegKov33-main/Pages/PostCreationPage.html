<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="../MediaAndStyle/Style.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Post Creation</title>
    <script
    src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onloadTurnstileCallback"
    defer
></script>
</head>
<body>
    <nav>
        <a href="/">Home</a>
        <a href="/profile">Profile</a>
        <a href="/post-creation">Make a story</a>
        <a href="/story-ranking">Story Ranking</a>
        <a href="/author-ranking">Author Ranking</a>
        <a href="/reader-ranking">Active Readers</a>
        <a href="/tags"> Tags</a>
    </nav>
    <form action="/post" method="post" id="createPost">
        <div>
            <label for="TitleInput">Title</label>
            <input  name="StoryTitleInput" type="text" id="TitleInput"
                    placeholder="Story must contain a title." required>
        </div>

        <div class="Choice">

            <input  checked type="radio" name="Visibility"
                    id="PublicChoice" value="Public">
            <label>Public</label>

            <input  type="radio" name="Visibility"
                    id="PrivateChoice" value="Private">
            <label>Private</label>
            
        </div>

        <div class="Choice">

            <input checked type="radio" name="Status" id="AuthorChoice" value="Author">
            <label>Author name</label>

            <input type="radio" name="Status" id="AnonymousChoice" value="Anonymous">
            <label>Anonymous</label>

            <input type="radio" name="Status" id="GuestChoice" value="Guest">
            <label >Guest</label>
        </div>
        
        <div>
            <label for="Content"> Content</label>
            <textarea   wrap="soft" id="Content" name="ContentInput"
                        placeholder="The story cannot be empty." rows="30" cols="100" required
            ></textarea>
        </div>

        <!--TAGS TAKEN FROM CHATGPT: "give me a list of topic genres for micro stories?"-->
        <div id="tags">
            <label for="genre-select">Select up to 5 genres:</label>
            <label><input type="checkbox" name="Tags" value="Fantasy & Mythology">Fantasy & Mythology</label><br>
            <label><input type="checkbox" name="Tags" value="Science Fiction & Futurism">Science Fiction & Futurism</label><br>
            <label><input type="checkbox" name="Tags" value="Horror & Thriller">Horror & Thriller</label><br>
            <label><input type="checkbox" name="Tags" value="Mystery & Crime">Mystery & Crime</label><br>
            <label><input type="checkbox" name="Tags" value="Romance & Relationships">Romance & Relationships</label><br>
            <label><input type="checkbox" name="Tags" value="Drama & Slice of Life">Drama & Slice of Life</label><br>
            <label><input type="checkbox" name="Tags" value="Humor & Satire">Humor & Satire</label><br>
            <label><input type="checkbox" name="Tags" value="Historical & Alternate History">Historical & Alternate History</label><br>
            <label><input type="checkbox" name="Tags" value="Experimental & Abstract">Experimental & Abstract</label><br>
        </div>

        <div class="Choice">
            <!-- CODE BLOCK GENERATED BY DEEPSEEK BELOW -->
            <p id="wordCount">Words: 0/500</p>
            <!-- CODE BLOCK GENERATED BY DEEPSEEK ABOVE -->
        <button type="submit" id="Create">Create</button>
        </div>
    </form>
    <div id="validation"></div>
</body>



<script>
    document.forms[0].style="display:none;"
    document.getElementById("validation").style="display:flex;justify-content:center;";

    window.onloadTurnstileCallback = function () {
        turnstile.render("#validation", {
            sitekey: "0x4AAAAAAA_a6xfzJMEeibX8",
            callback: function (token) {
            console.log(`Challenge Success ${token}`);
            setTimeout(() =>{
                document.forms[0].style="display:'';"
                document.getElementById("validation").style="display:none;"
            }, 2000)
            },
        });
    };
</script>



<!-- CODE BLOCK GENERATED BY DEEPSEEK AND CHATGPT BELOW -->
<script>
    if(document.cookie === ''){
        document.getElementById("PrivateChoice").disabled="true";
        document.getElementById("AuthorChoice").disabled="true"
        document.getElementById("AnonymousChoice").disabled="true";
        document.getElementById("GuestChoice").checked="true";
    }
    else{
        document.getElementById("GuestChoice").disabled="true";
    }
    const textarea = document.getElementById('Content');
    const wordCountDisplay = document.getElementById('wordCount');

    textarea.addEventListener('input', () => {
        
      const words = textarea.value.trim().split(/\s+/).filter(Boolean); // Split text into words
        const wordCount = words.length;

      // Update word count display
        wordCountDisplay.textContent = `Words: ${wordCount}/500`;

      // Enforce word limit
        if (wordCount > 500) {
            const truncatedText = words.slice(0, 500).join(' '); // Truncate to 500 words
            textarea.value = truncatedText;
            wordCountDisplay.textContent = `Words: 500/500 (Limit reached)`;
        }
    });

    document.getElementById('createPost').addEventListener('submit', function(e) {
        // Find all the checked checkboxes within the labels
        const checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
      
        // If no checkboxes are checked, alert the user and prevent form submission
        if (checkboxes.length === 0) {
          alert('Please select at least one tag.');
          e.preventDefault(); // Prevent form submission
        }
        if (checkboxes.length >5) {
            alert('Please select only up to 5 tags.');
            e.preventDefault(); // Prevent form submission
          }
      });
</script>
<!-- CODE BLOCK GENERATED BY DEEPSEEK AND CHATGPT ABOVE -->
</html>

<!-- Here must be a few things:
1. fields for (title, 500 word box, visible/not, author/anonimous)
2. create a suitable color/information combination
3. for vis and author make a (checkbox with a tick) AND question mark (info)
4. add IDs and hook up the script file. (THIS>Script>Server>Database) -->